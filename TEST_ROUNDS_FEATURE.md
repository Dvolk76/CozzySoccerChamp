# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ "–õ–∏–¥–µ—Ä–±–æ—Ä–¥ –ø–æ —Ç—É—Ä–∞–º"

## üß™ –ß—Ç–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç**

#### –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (Express)
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å backend
npm run dev

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å API
curl http://localhost:3000/api/leaderboard/by-rounds
```

#### Cloudflare Workers
```bash
# –î–µ–ø–ª–æ–π
npx wrangler deploy

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API
curl https://your-worker.workers.dev/api/leaderboard/by-rounds
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "rounds": [
    {
      "round": 1,
      "leaderboard": [
        {
          "userId": "...",
          "userName": "John Doe",
          "points": 15,
          "exactCount": 2,
          "diffCount": 1,
          "outcomeCount": 1,
          "cumulativePoints": 15
        }
      ]
    }
  ]
}
```

### 2. **Frontend UI**

#### –ó–∞–ø—É—Å–∫
```bash
cd client
npm run dev
```

#### –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤**
1. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å —Ç–∞–± "–õ–∏–¥–µ—Ä—ã"
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫—Ä—ã—Ç "–û–±—â–∏–π –∑–∞—á–µ—Ç"
3. ‚úÖ –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ü–æ —Ç—É—Ä–∞–º"
4. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–∑–º–µ–Ω–∏–ª—Å—è
5. ‚úÖ –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ "–û–±—â–∏–π –∑–∞—á–µ—Ç"
6. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—ã–±–æ—Ä —Ç—É—Ä–∞**
1. ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ "–ü–æ —Ç—É—Ä–∞–º"
2. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞–Ω –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ç—É—Ä
3. ‚úÖ –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É –¥—Ä—É–≥–æ–≥–æ —Ç—É—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¢—É—Ä 1")
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ª–∏–¥–µ—Ä–±–æ—Ä–¥ –æ–±–Ω–æ–≤–∏–ª—Å—è
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç—É—Ä–∞ –≤—ã–¥–µ–ª–µ–Ω–∞

**–°—Ü–µ–Ω–∞—Ä–∏–π 3: –î–∞–Ω–Ω—ã–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞**
1. ‚úÖ –í—ã–±—Ä–∞—Ç—å –ª—é–±–æ–π —Ç—É—Ä
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–∫–∞–∑–∞–Ω—ã:
   - –ù–æ–º–µ—Ä –º–µ—Å—Ç–∞ (—Å –º–µ–¥–∞–ª—è–º–∏ –¥–ª—è —Ç–æ–ø-3)
   - –ò–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞
   - –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ø–∞–¥–∞–Ω–∏–π (5√ó2, 3√ó1 –∏ —Ç.–¥.)
   - **–û—á–∫–∏ –∑–∞ —Ç—É—Ä** (–∫—Ä—É–ø–Ω–æ, —Å–∏–Ω–∏–º)
   - **–û–±—â–∏–π —Å—á–µ—Ç** (—Å–ø—Ä–∞–≤–∞, —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å)
3. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–æ–ø-3 –∏–º–µ—é—Ç –∑–æ–ª–æ—Ç—ã–µ/—Å–µ—Ä–µ–±—Ä—è–Ω—ã–µ/–±—Ä–æ–Ω–∑–æ–≤—ã–µ –º–µ–¥–∞–ª–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π 4: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö**
1. ‚úÖ –ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤, –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è:
   - "–ù–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç—É—Ä–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"

**–°—Ü–µ–Ω–∞—Ä–∏–π 5: –û—à–∏–±–∫–∏**
1. ‚úÖ –û—Ç–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
2. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å –∫–Ω–æ–ø–∫–æ–π "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å"

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö**

#### SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—É—Ä–æ–≤
```sql
-- PostgreSQL
SELECT DISTINCT matchday 
FROM "Match" 
WHERE status = 'FINISHED' 
  AND matchday IS NOT NULL
ORDER BY matchday;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –Ω–∞ —Ç—É—Ä
SELECT m.matchday, COUNT(p.id) as predictions_count
FROM "Match" m
LEFT JOIN "Prediction" p ON p."matchId" = m.id
WHERE m.status = 'FINISHED' 
  AND m.matchday IS NOT NULL
GROUP BY m.matchday
ORDER BY m.matchday;
```

#### –†—É—á–Ω–æ–π —Ä–∞—Å—á–µ—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
```
–¢—É—Ä 1:
- –ú–∞—Ç—á 1: User A —É–≥–∞–¥–∞–ª —Ç–æ—á–Ω—ã–π —Å—á–µ—Ç = 5 –æ—á–∫–æ–≤
- –ú–∞—Ç—á 2: User A —É–≥–∞–¥–∞–ª —Ä–∞–∑–Ω–∏—Ü—É = 3 –æ—á–∫–∞
–ò—Ç–æ–≥–æ –∑–∞ —Ç—É—Ä: 8 –æ—á–∫–æ–≤
–û–±—â–∏–π —Å—á–µ—Ç: 8 –æ—á–∫–æ–≤

–¢—É—Ä 2:
- –ú–∞—Ç—á 3: User A —É–≥–∞–¥–∞–ª –∏—Å—Ö–æ–¥ = 2 –æ—á–∫–∞
–ò—Ç–æ–≥–æ –∑–∞ —Ç—É—Ä: 2 –æ—á–∫–∞
–û–±—â–∏–π —Å—á–µ—Ç: 8 + 2 = 10 –æ—á–∫–æ–≤
```

### 4. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å**

**Desktop (Chrome/Firefox/Safari)**
1. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ç—É—Ä–æ–≤

**Mobile (Telegram WebApp)**
1. ‚úÖ –û—Ç–∫—Ä—ã—Ç—å –≤ Telegram
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ –Ω–µ –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ç—É—Ä–æ–≤
4. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–µ–¥–∞–ª–∏ –∏ —Ç–µ–∫—Å—Ç —á–∏—Ç–∞–µ–º—ã

**–¢–µ–º–Ω–∞—è —Ç–µ–º–∞**
1. ‚úÖ –í–∫–ª—é—á–∏—Ç—å —Ç–µ–º–Ω—É—é —Ç–µ–º—É –≤ Telegram
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ —Ü–≤–µ—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–µ–∫—Å—Ç —á–∏—Ç–∞–µ–º

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–¥–µ

### Backend
- [ ] `src/routes/leaderboard.ts` - —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/leaderboard/by-rounds`
- [ ] `src/routes/worker-adapters.ts` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Workers
- [ ] `src/worker.ts` - –ø–µ—Ä–µ–¥–∞—á–∞ `prisma` –≤ handler

### Frontend
- [ ] `client/src/types.ts` - —Ç–∏–ø—ã `RoundLeaderboard`, `RoundLeaderboardEntry`
- [ ] `client/src/api.ts` - –º–µ—Ç–æ–¥ `getLeaderboardByRounds()`
- [ ] `client/src/hooks/useData.ts` - —Ö—É–∫ `useLeaderboardByRounds()`
- [ ] `client/src/views/LeaderboardView.tsx` - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**
- ‚è±Ô∏è –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ç—É—Ä–∞–º: < 1 —Å–µ–∫—É–Ω–¥–∞
- üì¶ –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ API: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç—É—Ä–æ–≤ –∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- üîÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î: 1 (—Å includes)

**–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API
time curl http://localhost:3000/api/leaderboard/by-rounds

# –í –±—Ä–∞—É–∑–µ—Ä–µ (DevTools > Network)
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
```

## üêõ –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ —Ç—É—Ä–æ–≤
**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –º–∞—Ç—á–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É –º–∞—Ç—á–µ–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `matchday`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –º–∞—Ç—á–µ–π (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 'FINISHED')

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—á–∫–∏
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏—Å—Ç–µ–º—É –ø–æ–¥—Å—á–µ—Ç–∞ –æ—á–∫–æ–≤ –≤ `src/services/scoring.ts`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `scoreHome` –∏ `scoreAway` –Ω–µ null
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏–∫—É –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ —Ç—É—Ä–∞–º

### –ü—Ä–æ–±–ª–µ–º–∞: UI –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ console.log –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `loading` –∏ `error`

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] Backend —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω (`npm run build`)
- [ ] Frontend —Å–æ–±—Ä–∞–Ω (`cd client && npm run build`)
- [ ] –í—Å–µ –ª–∏–Ω—Ç–µ—Ä –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- [ ] API —ç–Ω–¥–ø–æ–∏–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] UI –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Telegram WebApp
- [ ] –ù–µ—Ç console.error –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

## üöÄ –î–µ–ø–ª–æ–π

### Production (Cloudflare)
```bash
# Backend (Workers)
npx wrangler deploy

# Frontend (Pages) - –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main
git add .
git commit -m "feat: add historical leaderboard by rounds"
git push origin main
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
1. –û—Ç–∫—Ä—ã—Ç—å production URL
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–± "–õ–∏–¥–µ—Ä—ã"
3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ "–ü–æ —Ç—É—Ä–∞–º"
4. –í—ã–±—Ä–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç—É—Ä—ã
5. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

