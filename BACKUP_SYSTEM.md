# üóÑÔ∏è –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–µ–∫–∞–ø–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–µ–∫–∞–ø–∞ Cloudflare D1 –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
2. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–µ–∫–∞–ø (Cloudflare Cron)](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π-–±–µ–∫–∞–ø)
3. [–†—É—á–Ω–æ–π –±–µ–∫–∞–ø —á–µ—Ä–µ–∑ API](#—Ä—É—á–Ω–æ–π-–±–µ–∫–∞–ø-—á–µ—Ä–µ–∑-api)
4. [–õ–æ–∫–∞–ª—å–Ω—ã–π –±–µ–∫–∞–ø —á–µ—Ä–µ–∑ CLI](#–ª–æ–∫–∞–ª—å–Ω—ã–π-–±–µ–∫–∞–ø-—á–µ—Ä–µ–∑-cli)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ R2 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-r2-—Ö—Ä–∞–Ω–∏–ª–∏—â–∞)
6. [–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±–µ–∫–∞–ø–∞](#–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ-–∏–∑-–±–µ–∫–∞–ø–∞)
7. [–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram](#—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è-–≤-telegram)

---

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–µ–∫–∞–ø** –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron)
- ‚úÖ **–†—É—á–Ω–æ–π –±–µ–∫–∞–ø** —á–µ—Ä–µ–∑ API –∏–ª–∏ CLI
- ‚úÖ **–•—Ä–∞–Ω–µ–Ω–∏–µ –≤ R2** (Cloudflare Object Storage)
- ‚úÖ **–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ webhook** (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ R2)
- ‚úÖ **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ —Å—Ç–∞—Ç—É—Å–µ –±–µ–∫–∞–ø–æ–≤
- ‚úÖ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞** —Å—Ç–∞—Ä—ã—Ö –±–µ–∫–∞–ø–æ–≤ (—Ö—Ä–∞–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30)
- ‚úÖ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** –∏–∑ –±–µ–∫–∞–ø–∞ —á–µ—Ä–µ–∑ API –∏–ª–∏ CLI
- ‚úÖ **–≠–∫—Å–ø–æ—Ä—Ç —Å—Ö–µ–º—ã –ë–î** –≤–º–µ—Å—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏

---

## ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–µ–∫–∞–ø

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

–ë–µ–∫–∞–ø—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º—É –≤ `wrangler.toml`:

```toml
[triggers]
crons = ["0 3 * * *"]  # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 UTC
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:**
- `"0 3 * * *"` - –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 UTC
- `"0 */6 * * *"` - –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
- `"0 0 * * 0"` - –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ –ø–æ–ª–Ω–æ—á—å
- `"0 0 1 * *"` - –ø–µ—Ä–≤–æ–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. Cloudflare Workers –≤—ã–ø–æ–ª–Ω—è–µ—Ç scheduled event –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `handleScheduledBackup` –∏–∑ `src/cron/backup-job.ts`
3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü: User, Match, Prediction, PredictionHistory, Score
4. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ R2 –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ webhook
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ç–∞—Ä—ã–µ –±–µ–∫–∞–ø—ã (–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30)
6. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

---

## üîß –†—É—á–Ω–æ–π –±–µ–∫–∞–ø —á–µ—Ä–µ–∑ API

### –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∫–∞–ø–∞

**Endpoint:** `POST /api/backup/create`  
**–¢—Ä–µ–±—É–µ—Ç:** –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
curl -X POST https://your-worker.workers.dev/api/backup/create \
  -H "X-Telegram-Init-Data: <telegram-init-data>"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "Backup created successfully",
  "timestamp": "2025-10-06T12:00:00.000Z",
  "tables": ["User", "Match", "Prediction", "PredictionHistory", "Score"],
  "size": 15420,
  "location": "r2://backup-2025-10-06T12-00-00-000Z.json"
}
```

### –°–ø–∏—Å–æ–∫ –±–µ–∫–∞–ø–æ–≤

**Endpoint:** `GET /api/backup/list`  
**–¢—Ä–µ–±—É–µ—Ç:** –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
curl https://your-worker.workers.dev/api/backup/list \
  -H "X-Telegram-Init-Data: <telegram-init-data>"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "backups": [
    {
      "key": "backup-2025-10-06T12-00-00-000Z.json",
      "size": 15420,
      "uploaded": "2025-10-06T12:00:00.000Z",
      "metadata": {
        "timestamp": "2025-10-06T12:00:00.000Z",
        "tables": "User,Match,Prediction,PredictionHistory,Score",
        "size": "15420"
      }
    }
  ],
  "count": 1
}
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±–µ–∫–∞–ø–∞

**Endpoint:** `POST /api/backup/restore`  
**–¢—Ä–µ–±—É–µ—Ç:** –ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```bash
curl -X POST https://your-worker.workers.dev/api/backup/restore \
  -H "X-Telegram-Init-Data: <telegram-init-data>" \
  -H "Content-Type: application/json" \
  -d '{"backupKey": "backup-2025-10-06T12-00-00-000Z.json"}'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "Database restored successfully",
  "tablesRestored": ["User", "Match", "Prediction", "PredictionHistory", "Score"]
}
```

---

## üíª –õ–æ–∫–∞–ª—å–Ω—ã–π –±–µ–∫–∞–ø —á–µ—Ä–µ–∑ CLI

### –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∫–∞–ø–∞

```bash
# –ë–µ–∫–∞–ø –≤ —Ñ–∞–π–ª —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
node scripts/manual-backup.mjs

# –ë–µ–∫–∞–ø –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
node scripts/manual-backup.mjs --output my-backup.json
```

**–í—ã–≤–æ–¥:**
```
üîÑ Creating database backup...
üì¶ Database: cozy-soccer-champ-db
üìÅ Output: backup-2025-10-06T12-00-00-000Z.json
üìä Exporting User...
   ‚úì 25 rows
üìä Exporting Match...
   ‚úì 125 rows
...
‚úÖ Backup completed successfully!
üìÅ File: /path/to/backup-2025-10-06T12-00-00-000Z.json
üíæ Size: 15.08 KB
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±–µ–∫–∞–ø–∞

```bash
# –° –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
node scripts/restore-backup.mjs --input backup.json

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
node scripts/restore-backup.mjs --input backup.json --confirm
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ó–ê–ú–ï–ù–Ø–ï–¢ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ!

---

## ‚òÅÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ R2 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ R2 bucket

```bash
wrangler r2 bucket create cozy-soccer-backups
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ wrangler.toml

–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ü–∏—é R2 –≤ `wrangler.toml`:

```toml
[[r2_buckets]]
binding = "BACKUP_BUCKET"
bucket_name = "cozy-soccer-backups"
```

### 3. Deploy

```bash
npm run deploy
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Webhook

–ï—Å–ª–∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å R2, –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –±–µ–∫–∞–ø–æ–≤:

```bash
wrangler secret put BACKUP_WEBHOOK_URL
# –í–≤–µ–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ webhook (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –∏–ª–∏ Telegram Bot API)
```

---

## üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±–µ–∫–∞–ø–∞

### –ß–µ—Ä–µ–∑ API (—Å R2)

1. –ü–æ–ª—É—á–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –±–µ–∫–∞–ø–æ–≤:
   ```bash
   curl https://your-worker.workers.dev/api/backup/list \
     -H "X-Telegram-Init-Data: <telegram-init-data>"
   ```

2. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –±–µ–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   ```bash
   curl -X POST https://your-worker.workers.dev/api/backup/restore \
     -H "X-Telegram-Init-Data: <telegram-init-data>" \
     -H "Content-Type: application/json" \
     -d '{"backupKey": "backup-2025-10-06T12-00-00-000Z.json"}'
   ```

### –ß–µ—Ä–µ–∑ CLI (–ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª)

```bash
node scripts/restore-backup.mjs --input backup-2025-10-06T12-00-00-000Z.json
```

–°–∫—Ä–∏–ø—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
```
‚ö†Ô∏è  This will REPLACE all data in the database. Continue? (yes/no):
```

–í–≤–µ–¥–∏—Ç–µ `yes` –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è.

---

## üì± –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–ü–æ–ª—É—á–∏—Ç–µ Chat ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–∞—à–µ–º—É –±–æ—Ç—É
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ API: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
   - –ù–∞–π–¥–∏—Ç–µ `chat.id` –≤ –æ—Ç–≤–µ—Ç–µ

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç:**
   ```bash
   wrangler secret put TELEGRAM_ADMIN_CHAT_ID
   # –í–≤–µ–¥–∏—Ç–µ chat ID (—á–∏—Å–ª–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: 123456789)
   ```

3. **Deploy:**
   ```bash
   npm run deploy
   ```

### –ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–£—Å–ø–µ—à–Ω—ã–π –±–µ–∫–∞–ø:**
```
‚úÖ Database Backup Successful

üìÖ Time: 2025-10-06T03:00:00.000Z
üìä Tables: User, Match, Prediction, PredictionHistory, Score
üíæ Size: 15.08 KB
üìç Location: r2://backup-2025-10-06T03-00-00-000Z.json
```

**–û—à–∏–±–∫–∞ –±–µ–∫–∞–ø–∞:**
```
‚ùå Database Backup Failed

‚ö†Ô∏è Error: Connection timeout
üìÖ Time: 2025-10-06T03:00:00.000Z
```

---

## üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
/Users/dmitryvolkov/CozzySoccerChamp/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backup.ts                  # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –±–µ–∫–∞–ø–∞
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ worker-adapters.ts         # API –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (backupHandler)
‚îÇ   ‚îú‚îÄ‚îÄ cron/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backup-job.ts              # Cron job –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–µ–∫–∞–ø–∞
‚îÇ   ‚îî‚îÄ‚îÄ worker.ts                      # –ì–ª–∞–≤–Ω—ã–π worker (+ scheduled handler)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ manual-backup.mjs              # CLI —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±–µ–∫–∞–ø–∞
‚îÇ   ‚îî‚îÄ‚îÄ restore-backup.mjs             # CLI —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ wrangler.toml                      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (cron, R2)
‚îî‚îÄ‚îÄ BACKUP_SYSTEM.md                   # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–î–æ—Å—Ç—É–ø –∫ API:** –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (–ø—Ä–æ–≤–µ—Ä–∫–∞ `user.role === 'ADMIN'`)
2. **R2 Bucket:** –ü—Ä–∏–≤–∞—Ç–Ω—ã–π, –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–∞—à–µ–º—É Worker
3. **Secrets:** –•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏ chat ID –≤ Cloudflare Secrets (–Ω–µ –≤ –∫–æ–¥–µ!)
4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç —è–≤–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ CLI

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –≤ Cloudflare Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Cloudflare Dashboard](https://dash.cloudflare.com)
2. Workers & Pages ‚Üí –í–∞—à worker ‚Üí Logs
3. –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ "backup" –∏–ª–∏ "scheduled"

### –õ–æ–∫–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ (dev —Ä–µ–∂–∏–º)

```bash
npm run dev:worker
# –õ–æ–≥–∏ –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏
```

---

## üöÄ Quick Start

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–±–µ–∑ R2)

1. **Deploy worker —Å cron:**
   ```bash
   npm run deploy
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ scheduled events:**
   ```bash
   wrangler tail
   ```

–ë–µ–∫–∞–ø—ã –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è, –Ω–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è).

### –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—Å R2 –∏ Telegram)

1. **–°–æ–∑–¥–∞–π—Ç–µ R2 bucket:**
   ```bash
   wrangler r2 bucket create cozy-soccer-backups
   ```

2. **–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ R2 –≤ wrangler.toml:**
   ```toml
   [[r2_buckets]]
   binding = "BACKUP_BUCKET"
   bucket_name = "cozy-soccer-backups"
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   ```bash
   wrangler secret put TELEGRAM_ADMIN_CHAT_ID
   ```

4. **Deploy:**
   ```bash
   npm run deploy
   ```

5. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä—É—á–Ω–æ–π –±–µ–∫–∞–ø:**
   ```bash
   curl -X POST https://your-worker.workers.dev/api/backup/create \
     -H "X-Telegram-Init-Data: <telegram-init-data>"
   ```

---

## üêõ Troubleshooting

### Cron –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

- **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:** `wrangler tail`
- **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç cron:** [crontab.guru](https://crontab.guru)
- **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ worker –∑–∞–¥–µ–ø–ª–æ–µ–Ω:** `npm run deploy`

### R2 bucket –Ω–µ –Ω–∞–π–¥–µ–Ω

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ buckets
wrangler r2 bucket list

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ bucket_name –≤ wrangler.toml —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º
```

### Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
wrangler secret list

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ chat ID (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∏—Å–ª–æ)
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –≤ —ç—Ç–æ—Ç —á–∞—Ç
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

- **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–æ—Ä–º–∞—Ç –±–µ–∫–∞–ø–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π** (JSON —Å –ø–æ–ª—è–º–∏ `timestamp`, `tables`, `schema`)
- **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ API
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--confirm` —Ñ–ª–∞–≥** –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ CLI –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Cloudflare Workers Cron Triggers](https://developers.cloudflare.com/workers/configuration/cron-triggers/)
- [Cloudflare R2 Documentation](https://developers.cloudflare.com/r2/)
- [Cloudflare D1 Documentation](https://developers.cloudflare.com/d1/)
- [Wrangler CLI Reference](https://developers.cloudflare.com/workers/wrangler/)

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–•—Ä–∞–Ω–∏—Ç–µ –±–µ–∫–∞–ø—ã –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö:**
   - R2 bucket (–æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
   - –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–π—Ç–µ —á–µ—Ä–µ–∑ CLI)
   - –í–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä (—á–µ—Ä–µ–∑ webhook)

2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:**
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ, —á—Ç–æ –±–µ–∫–∞–ø—ã –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä:**
   - –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Ä–∞–∑–º–µ—Ä–æ–º –±–µ–∫–∞–ø–æ–≤
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫—É —Å—Ç–∞—Ä—ã—Ö –±–µ–∫–∞–ø–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 –¥–Ω–µ–π)

4. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –≤ Cloudflare Dashboard –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ

---

**–°–æ–∑–¥–∞–Ω–æ:** 6 –æ–∫—Ç—è–±—Ä—è 2025  
**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–í–µ—Ä—Å–∏—è:** 1.0

