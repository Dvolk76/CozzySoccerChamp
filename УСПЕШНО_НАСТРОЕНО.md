# üéâ –£–°–ü–ï–®–ù–û! –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–µ–∫–∞–ø –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–µ–∫–∞–ø
```
–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 UTC (06:00 –ú–°–ö)
–°—Ç–∞—Ç—É—Å: ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω
Worker: https://cozy-soccer-champ.cozzy-soccer.workers.dev
Cron: 0 3 * * *
```

### 2. ‚úÖ R2 –æ–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```
Bucket: cozy-soccer-backups
–°–æ–∑–¥–∞–Ω: 2025-10-06T15:46:17.099Z
–°—Ç–∞—Ç—É—Å: ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω
–•—Ä–∞–Ω–µ–Ω–∏–µ: –ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –±–µ–∫–∞–ø–æ–≤
```

### 3. ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –±–µ–∫–∞–ø
```
–ö–æ–º–∞–Ω–¥–∞: npm run backup
–¢–µ—Å—Ç: backup-2025-10-06T15-36-34-265Z.json (4.20 KB)
–°—Ç–∞—Ç—É—Å: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```

### 4. ‚úÖ API endpoints
```
POST /api/backup/create    - –°–æ–∑–¥–∞—Ç—å –±–µ–∫–∞–ø (–∞–¥–º–∏–Ω)
GET  /api/backup/list      - –°–ø–∏—Å–æ–∫ –±–µ–∫–∞–ø–æ–≤ (–∞–¥–º–∏–Ω)
POST /api/backup/restore   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (–∞–¥–º–∏–Ω)
–°—Ç–∞—Ç—É—Å: ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç
```

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|-----------|--------|--------|
| –ê–≤—Ç–æ–±–µ–∫–∞–ø—ã | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 03:00 UTC |
| R2 Storage | ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω | cozy-soccer-backups |
| CLI –±–µ–∫–∞–ø—ã | ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç | `npm run backup` |
| API | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –î–ª—è –∞–¥–º–∏–Ω–æ–≤ |
| –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ | ‚úÖ –í–∫–ª—é—á–µ–Ω–∞ | –•—Ä–∞–Ω–∏—Ç 30 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö |

---

## üíª –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

```bash
# –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –±–µ–∫–∞–ø –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
npm run backup

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞
npm run backup:restore -- --input backup.json

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ worker
wrangler tail

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å R2 buckets
npm run r2:list
```

---

## üïê –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

**–ó–∞–≤—Ç—Ä–∞ –≤ 03:00 UTC (06:00 –ø–æ –ú–æ—Å–∫–≤–µ):**

1. Cloudflare Worker –∑–∞–ø—É—Å—Ç–∏—Ç cron job
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã:
   - User
   - Match
   - Prediction
   - PredictionHistory
   - Score
3. –°–æ–∑–¥–∞—Å—Ç—Å—è —Ñ–∞–π–ª: `backup-YYYY-MM-DDTHH-mm-ss-sssZ.json`
4. –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ R2 bucket
5. –£–¥–∞–ª—è—Ç—Å—è –±–µ–∫–∞–ø—ã —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
6. –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

**–ò —Ç–∞–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!** ‚è∞

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É:

### –°–µ–π—á–∞—Å:
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –±–µ–∫–∞–ø
npm run backup
```

### –ó–∞–≤—Ç—Ä–∞ –ø–æ—Å–ª–µ 03:00 UTC:
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
wrangler tail

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–µ–∫–∞–ø—ã –≤ R2 (—á–µ—Ä–µ–∑ API, –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞)
# GET https://cozy-soccer-champ.cozzy-soccer.workers.dev/api/backup/list
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∫–∞–ø–∞:

```json
{
  "timestamp": "2025-10-06T03:00:00.000Z",
  "version": "1.0",
  "tables": {
    "User": [...],           // –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
    "Match": [...],          // –í—Å–µ –º–∞—Ç—á–∏
    "Prediction": [...],     // –í—Å–µ –ø—Ä–æ–≥–Ω–æ–∑—ã
    "PredictionHistory": [...], // –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
    "Score": [...]           // –û—á–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  },
  "schema": [...]            // –°—Ö–µ–º–∞ –ë–î –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
}
```

---

## üéØ –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:

### Core (TypeScript):
- `src/services/backup.ts` - –°–µ—Ä–≤–∏—Å –±–µ–∫–∞–ø–∞
- `src/cron/backup-job.ts` - Scheduled job
- `src/routes/worker-adapters.ts` - API handlers
- `src/worker.ts` - Worker —Å cron

### Scripts (CLI):
- `scripts/manual-backup.mjs` - –õ–æ–∫–∞–ª—å–Ω—ã–π –±–µ–∫–∞–ø
- `scripts/restore-backup.mjs` - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- `scripts/quick-setup.sh` - –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- `scripts/test-backup-api.sh` - –¢–µ—Å—Ç API

### Config:
- `wrangler.toml` - Cron + R2 –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- `package.json` - –ö–æ–º–∞–Ω–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `–ì–û–¢–û–í–û.md` - ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
- `START_HERE.md` - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- `FINAL_STEPS.md` - –î–µ—Ç–∞–ª—å–Ω—ã–µ —à–∞–≥–∏
- `BACKUP_SYSTEM.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `BACKUP_QUICKSTART.md` - –ö—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

‚úÖ R2 bucket –ø—Ä–∏–≤–∞—Ç–Ω—ã–π (—Ç–æ–ª—å–∫–æ –≤–∞—à worker –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø)  
‚úÖ API —Ç—Ä–µ–±—É–µ—Ç –∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±–µ–∫–∞–ø–æ–≤  
‚úÖ –ë–µ–∫–∞–ø—ã –≤–∫–ª—é—á–∞—é—Ç —Å—Ö–µ–º—É –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è  
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  

---

## üöÄ –ë–æ–Ω—É—Å: –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ

### 1. Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
```bash
# –ü–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –±–µ–∫–∞–ø–æ–≤
# –°–º. FINAL_STEPS.md –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

### 2. –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ:
```toml
# –í wrangler.toml:
[triggers]
crons = ["0 */6 * * *"]  # –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
crons = ["0 0 * * 0"]    # –ö–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
crons = ["0 0 1 * *"]    # –†–∞–∑ –≤ –º–µ—Å—è—Ü
```

### 3. Webhook –¥–ª—è –±–µ–∫–∞–ø–æ–≤:
```bash
# –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä
wrangler secret put BACKUP_WEBHOOK_URL
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞:

### –õ–æ–≥–∏:
```bash
wrangler tail
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- Cloudflare Workers Cron: https://developers.cloudflare.com/workers/configuration/cron-triggers/
- Cloudflare R2: https://developers.cloudflare.com/r2/

---

## üéä –ò—Ç–æ–≥:

**üéâ –ì–û–¢–û–í–û! –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–µ–∫–∞–ø–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!**

‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±–µ–∫–∞–ø—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å  
‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ R2 –æ–±–ª–∞–∫–µ  
‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–µ –±–µ–∫–∞–ø—ã –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é  
‚úÖ API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞  

**–ü–µ—Ä–≤—ã–π –∞–≤—Ç–æ–±–µ–∫–∞–ø: –ó–∞–≤—Ç—Ä–∞ –≤ 03:00 UTC (06:00 –ú–°–ö)** ‚è∞

**–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!** üõ°Ô∏è

---

*–î–∞—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: 6 –æ–∫—Ç—è–±—Ä—è 2025*  
*Worker: https://cozy-soccer-champ.cozzy-soccer.workers.dev*  
*R2 Bucket: cozy-soccer-backups*

